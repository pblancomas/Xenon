#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "8B_flux.h"
#include "interpolators.h"

#define SIZE 82

double dphidEnu(double Enu){
//input: neutrino energy in MeV.  Output: flux in MeV^-1 cm^-2 s^-1. From https://arxiv.org/pdf/astro-ph/0412440, added 0.0 and 16.0 at 0.0 flux
    
    //int size = 82;
    
    double X[SIZE] = {
    0.0, 0.1047, 0.1139, 0.12056, 0.13086, 0.14192, 0.15479, 0.16842, 0.18325, 0.20003, 0.21799,
    0.23833, 0.26057, 0.2814, 0.30169, 0.32485, 0.34996, 0.3707, 0.40065, 0.43608, 0.47828,
    0.50895, 0.55511, 0.60544, 0.65875, 0.71178, 0.76149, 0.82487, 0.94807, 1.03155, 1.12962,
    1.23017, 1.32234, 1.44649, 1.61401, 1.77086, 1.92825, 2.09276, 2.29135, 2.47646, 2.70247,
    2.93492, 3.17288, 3.42405, 3.67561, 3.87942, 4.14432, 4.449, 4.90261, 5.3283, 6.03497,
    6.75701, 7.35469, 8.17667, 8.73336, 9.47642, 10.23558, 11.02211, 11.74514, 12.31819, 12.76533,
    13.12855, 13.42342, 13.66088, 13.87007, 14.06191, 14.21895, 14.38194, 14.52556, 14.6792, 14.81279,
    14.94324, 15.01097, 15.15641, 15.3111, 15.3954, 15.49471, 15.6129, 15.70443, 15.75499, 15.81959, 16.0
    };

    
    double Y[SIZE] = {
    0.0, 1187.22615, 1401.10967, 1609.74246, 1886.78567, 2211.49239, 2592.217, 3038.4171, 3561.42193, 4174.57842, 4893.22561,
    5735.76056, 6723.36652, 7725.97489, 8703.84927, 9805.88903, 11267.91626, 12517.25426, 14268.27815, 16622.14446, 19264.1804,
    22133.83842, 25944.34082, 30410.8491, 35645.48954, 40961.25755, 46144.7799, 54085.4459, 67300.34391, 78884.79854, 92468.89617,
    106266.52582, 122107.97638, 138830.13374, 167811.26326, 196712.21585, 226064.1159, 256726.81408, 293885.61508, 329802.1833, 371607.06569,
    417041.13793, 448993.0782, 493217.3583, 521414.1864, 566905.39423, 611370.8272, 651699.39443, 705927.34318, 732053.26932, 759723.52472,
    760533.07545, 728814.21968, 668889.11072, 640491.26202, 526088.86071, 415363.70508, 297092.31845, 196334.22771, 127191.09674, 82388.83531,
    53364.06626, 34562.53138, 22384.275, 14496.76013, 9388.42827, 6080.00683, 3937.46256, 2549.89811, 1651.3214, 1069.38579,
    692.52589, 460.42478, 285.67774, 188.07571, 121.7926, 78.8702, 51.07516, 33.07497, 21.41797, 15.6147, 0.0
    };
   
    
    double y0;
    y0 = linearInterpolation(X, Y, SIZE, Enu); 

    return y0;

}
